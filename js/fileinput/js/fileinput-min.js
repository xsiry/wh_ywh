(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof module==="object"&&module.exports){module.exports=a(require("jquery"))}else{a(window.jQuery)}}}(function(E){E.fn.fileinputLocales={};var j,U,D,m,S,u,W,w,l,A,B,h,L,c,b,y,p,t,Q,C,d,F,Z,s,aa,P,x,n,Y,i,I,N,H,M,f,g,z,G,a,O,R,X,T,o,v,J,K,r,q,e,V,k;j=function(ab){if(navigator.appName!=="Microsoft Internet Explorer"){return false}if(ab===10){return new RegExp("msie\\s"+ab,"i").test(navigator.userAgent)}var ad=document.createElement("div"),ac;ad.innerHTML="<!--[if IE "+ab+"]> <i></i> <![endif]-->";ac=ad.getElementsByTagName("i").length;document.body.appendChild(ad);ad.parentNode.removeChild(ad);return ac};U=function(){return new RegExp("Edge/[0-9]+","i").test(navigator.userAgent)};D=function(ac,ae,af,ab){var ad=ab?ae:ae+".fileinput";ac.off(ad).on(ad,af)};m={data:{},init:function(ac){var ab=ac.initialPreview,ad=ac.id;if(ab.length>0&&!v(ab)){ab=ab.split(ac.initialPreviewDelimiter)}m.data[ad]={content:ab,config:ac.initialPreviewConfig,tags:ac.initialPreviewThumbTags,delimiter:ac.initialPreviewDelimiter,template:ac.previewGenericTemplate,msg:function(ae){return ac.getMsgSelected(ae)},initId:ac.previewInitId,footer:ac.getLayoutTemplate("footer").replace(/\{progress}/g,ac.renderThumbProgress()),isDelete:ac.initialPreviewShowDelete,caption:ac.initialCaption,actions:function(ae,ai,ah,af,ag){return ac.renderFileActions(ae,ai,ah,af,ag)}}},fetch:function(ab){return m.data[ab].content.filter(function(ac){return ac!==null})},count:function(ac,ab){return !!m.data[ac]&&!!m.data[ac].content?(ab?m.data[ac].content.length:m.fetch(ac).length):0},get:function(ac,ah,aj){var ad="init_"+ah,ag=m.data[ac],ae=ag.config[ah],ai=ag.initId+"-"+ad,af,ab,ak=" file-preview-initial";aj=aj===undefined?true:aj;if(ag.content[ah]===null){return""}if(!o(ae)&&!o(ae.frameClass)){ak+=" "+ae.frameClass}af=ag.template.replace(/\{previewId}/g,ai).replace(/\{frameClass}/g,ak).replace(/\{fileindex}/g,ad).replace(/\{content}/g,ag.content[ah]).replace(/\{footer}/g,m.footer(ac,ah,aj));if(ag.tags.length&&ag.tags[ah]){af=e(af,ag.tags[ah])}if(!o(ae)&&!o(ae.frameAttr)){ab=E(document.createElement("div")).html(af);ab.find(".file-preview-initial").attr(ae.frameAttr);af=ab.html();ab.remove()}return af},add:function(ah,af,ae,ad,ab){var ag=E.extend(true,{},m.data[ah]),ac;if(!v(af)){af=af.split(ag.delimiter)}if(ab){ac=ag.content.push(af)-1;ag.config[ac]=ae;ag.tags[ac]=ad}else{ac=af.length;ag.content=af;ag.config=ae;ag.tags=ad}m.data[ah]=ag;return ac},set:function(ai,ag,ae,ad,ab){var ah=E.extend(true,{},m.data[ai]),af,ac;if(!ag||!ag.length){return}if(!v(ag)){ag=ag.split(ah.delimiter)}ac=ag.filter(function(aj){return aj!==null});if(!ac.length){return}if(ah.content===undefined){ah.content=[]}if(ah.config===undefined){ah.config=[]}if(ah.tags===undefined){ah.tags=[]}if(ab){for(af=0;af<ag.length;af++){if(ag[af]){ah.content.push(ag[af])}}for(af=0;af<ae.length;af++){if(ae[af]){ah.config.push(ae[af])}}for(af=0;af<ad.length;af++){if(ad[af]){ah.tags.push(ad[af])}}}else{ah.content=ag;ah.config=ae;ah.tags=ad}m.data[ai]=ah},unset:function(ad,ac){var ab=m.count(ad);if(!ab){return}if(ab===1){m.data[ad].content=[];m.data[ad].config=[];return}m.data[ad].content[ac]=null;m.data[ad].config[ac]=null},out:function(ag){var ae="",af=m.data[ag],ac,ab=m.count(ag,true);if(ab===0){return{content:"",caption:""}}for(var ad=0;ad<ab;ad++){ae+=m.get(ag,ad)}ac=af.msg(m.count(ag));return{content:ae,caption:ac}},footer:function(ac,ai,al){var ah=m.data[ac];al=al===undefined?true:al;if(ah.config.length===0||o(ah.config[ai])){return""}var ae=ah.config[ai],am=J("caption",ae)?ae.caption:"",ad=J("width",ae)?ae.width:"auto",ab=J("url",ae)?ae.url:false,ak=J("key",ae)?ae.key:null,ag=(ab===false)&&al,af=ah.isDelete?ah.actions(false,true,ag,ab,ak):"",aj=ah.footer.replace(/\{actions}/g,af);return aj.replace(/\{caption}/g,am).replace(/\{width}/g,ad).replace(/\{indicator}/g,"").replace(/\{indicatorTitle}/g,"")}};S=function(ab,ac){ac=ac||0;if(typeof ab==="number"){return ab}if(typeof ab==="string"){ab=parseFloat(ab)}return isNaN(ab)?ac:ab};u=function(){return window.File&&window.FileReader};W=function(){var ab=document.createElement("div");return !j(9)&&!U()&&(ab.draggable!==undefined||(ab.ondragstart!==undefined&&ab.ondrop!==undefined))};w=function(){return u()&&window.FormData};l=function(ac,ab){ac.removeClass(ab).addClass(ab)};A='style="width:{width};height:{height};"';B='      <param name="controller" value="true" />\n      <param name="allowFullScreen" value="true" />\n      <param name="allowScriptAccess" value="always" />\n      <param name="autoPlay" value="false" />\n      <param name="autoStart" value="false" />\n      <param name="quality" value="high" />\n';h='<div class="file-preview-other">\n   <span class="{previewFileIconClass}">{previewFileIcon}</span>\n</div>';L={removeIcon:'<i class="glyphicon glyphicon-trash text-danger"></i>',removeClass:"btn btn-xs btn-default",removeTitle:"Remove file",uploadIcon:'<i class="glyphicon glyphicon-upload text-info"></i>',uploadClass:"btn btn-xs btn-default",uploadTitle:"Upload file",indicatorNew:'<i class="glyphicon glyphicon-hand-down text-warning"></i>',indicatorSuccess:'<i class="glyphicon glyphicon-ok-sign text-success"></i>',indicatorError:'<i class="glyphicon glyphicon-exclamation-sign text-danger"></i>',indicatorLoading:'<i class="glyphicon glyphicon-hand-up text-muted"></i>',indicatorNewTitle:"Not uploaded yet",indicatorSuccessTitle:"Uploaded",indicatorErrorTitle:"Upload Error",indicatorLoadingTitle:"Uploading ..."};c='{preview}\n<div class="kv-upload-progress hide"></div>\n<div class="input-group {class}">\n   {caption}\n   <div class="input-group-btn">\n       {remove}\n       {cancel}\n       {upload}\n       {browse}\n   </div>\n</div>';b='{preview}\n<div class="kv-upload-progress hide"></div>\n{remove}\n{cancel}\n{upload}\n{browse}\n';y='<div class="file-preview {class}">\n    {close}    <div class="{dropClass}">\n    <div class="file-preview-thumbnails">\n    </div>\n    <div class="clearfix"></div>    <div class="file-preview-status text-center text-success"></div>\n    <div class="kv-fileinput-error"></div>\n    </div>\n</div>';t='<div class="close fileinput-remove">&times;</div>\n';p='<span class="glyphicon glyphicon-file kv-caption-icon"></span>';Q='<div tabindex="500" class="form-control file-caption {class}">\n   <div class="file-caption-name"></div>\n</div>\n';C='<button type="{type}" tabindex="500" title="{title}" class="{css}" {status}>{icon}{label}</button>';d='<a href="{href}" tabindex="500" title="{title}" class="{css}" {status}>{icon}{label}</a>';F='<div tabindex="500" class="{css}" {status}>{icon}{label}</div>';Z='<div id="{id}" class="file-preview-detail-modal modal fade" tabindex="-1">\n  <div class="modal-dialog modal-lg">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n        <h3 class="modal-title">{heading} <small>{title}</small></h3>\n      </div>\n      <div class="modal-body">\n           <pre>{body}</pre>\n      </div>\n    </div>\n  </div>\n</div>';s='<div class="progress">\n    <div class="{class}" role="progressbar" aria-valuenow="{percent}" aria-valuemin="0" aria-valuemax="100" style="width:{percent}%;">\n        {percent}%\n     </div>\n</div>';aa='<div class="file-thumbnail-footer">\n    <div class="file-footer-caption" title="{caption}">{caption}</div>\n    {progress} {actions}\n</div>';P='<div class="file-actions">\n    <div class="file-footer-buttons">\n        {upload}{delete}{other}    </div>\n    <div class="file-upload-indicator" title="{indicatorTitle}">{indicator}</div>\n    <div class="clearfix"></div>\n</div>';x='<button type="button" class="kv-file-remove {removeClass}" title="{removeTitle}" {dataUrl}{dataKey}>{removeIcon}</button>\n';n='<button type="button" class="kv-file-upload {uploadClass}" title="{uploadTitle}">   {uploadIcon}\n</button>\n';Y='<button type="button" class="btn btn-default btn-xs btn-block" title="{zoomTitle}: {caption}" onclick="{dialog}">\n   {zoomInd}\n</button>\n';i='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}">\n   {content}\n   {footer}\n</div>\n';I='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}">\n    <object class="file-object" data="{data}" type="{type}" width="{width}" height="{height}">\n       '+h+"\n    </object>\n   {footer}\n</div>";N='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}">\n   <img src="{data}" class="file-preview-image" title="{caption}" alt="{caption}" '+A+">\n   {footer}\n</div>\n";H='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}">\n   <pre class="file-preview-text" title="{caption}" '+A+">{data}</pre>\n   {zoom}\n   {footer}\n</div>";M='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}" title="{caption}" '+A+'>\n   <video width="{width}" height="{height}" controls>\n       <source src="{data}" type="{type}">\n       '+h+"\n   </video>\n   {footer}\n</div>\n";f='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}" title="{caption}" '+A+'>\n   <audio controls>\n       <source src="{data}" type="{type}">\n       '+h+"\n   </audio>\n   {footer}\n</div>";g='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}" title="{caption}" '+A+'>\n   <object class="file-object" type="application/x-shockwave-flash" width="{width}" height="{height}" data="{data}">\n'+B+"       "+h+"\n   </object>\n   {footer}\n</div>\n";z='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}" title="{caption}" '+A+'>\n   <object class="file-object" data="{data}" type="{type}" width="{width}" height="{height}">\n       <param name="movie" value="{caption}" />\n'+B+"         "+h+"\n   </object>\n   {footer}\n</div>";G='<div class="file-preview-frame{frameClass}" id="{previewId}" data-fileindex="{fileindex}" title="{caption}" '+A+'>\n   <div class="file-preview-other-frame">\n   '+h+'\n   </div>\n   <div class="file-preview-other-footer">{footer}</div>\n</div>';a={main1:c,main2:b,preview:y,close:t,zoom:Y,icon:p,caption:Q,modal:Z,progress:s,footer:aa,actions:P,actionDelete:x,actionUpload:n,btnDefault:C,btnLink:d,btnBrowse:F};O={generic:i,html:I,image:N,text:H,video:M,audio:f,flash:g,object:z,other:G};R=["image","html","text","video","audio","flash","object"];X={image:{width:"auto",height:"160px"},html:{width:"213px",height:"160px"},text:{width:"160px",height:"136px"},video:{width:"213px",height:"160px"},audio:{width:"213px",height:"80px"},flash:{width:"213px",height:"160px"},object:{width:"160px",height:"160px"},other:{width:"160px",height:"160px"}};T={image:function(ac,ab){return(ac!==undefined)?ac.match("image.*"):ab.match(/\.(gif|png|jpe?g)$/i)},html:function(ac,ab){return(ac!==undefined)?ac==="text/html":ab.match(/\.(htm|html)$/i)},text:function(ac,ab){return(ac!==undefined&&ac.match("text.*"))||ab.match(/\.(txt|md|csv|nfo|ini|json|php|js|css)$/i)},video:function(ac,ab){return(ac!==undefined&&ac.match(/\.video\/(ogg|mp4|webm|3gp)$/i))||ab.match(/\.(og?|mp4|webm|3gp)$/i)},audio:function(ac,ab){return(ac!==undefined&&ac.match(/\.audio\/(ogg|mp3|wav)$/i))||ab.match(/\.(ogg|mp3|wav)$/i)},flash:function(ac,ab){return(ac!==undefined&&ac==="application/x-shockwave-flash")||ab.match(/\.(swf)$/i)},object:function(){return true},other:function(){return true}};o=function(ac,ab){return ac===undefined||ac===null||ac.length===0||(ab&&E.trim(ac)==="")};v=function(ab){return Array.isArray(ab)||Object.prototype.toString.call(ab)==="[object Array]"};J=function(ac,ab){return(typeof ab==="object"&&ac in ab)};K=function(ab,ad,ac){return(o(ab)||o(ab[ad]))?ac:E(ab[ad])};r=function(){return Math.round(new Date().getTime()+(Math.random()*100))};q=function(ab){return ab.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};e=function(ad,ac){var ab=ad;if(!ac){return ab}E.each(ac,function(ae,af){if(typeof af==="function"){af=af()}ab=ab.split(ae).join(af)});return ab};V=window.URL||window.webkitURL;k=function(ad,ac){var ab=this;ab.$element=E(ad);if(!ab.validate()){return}ab.isPreviewable=u();ab.isIE9=j(9);ab.isIE10=j(10);if(ab.isPreviewable||ab.isIE9){ab.init(ac);ab.listen()}else{ab.$element.removeClass("file-loading")}};k.prototype={constructor:k,validate:function(){var ac=this,ab;if(ac.$element.attr("type")==="file"){return true}ab='<div class="help-block alert alert-warning"><h4>Invalid Input Type</h4>You must set an input <code>type = file</code> for <b>bootstrap-fileinput</b> plugin to initialize.</div>';ac.$element.after(ab);return false},init:function(ac){var ab=this,ae=ab.$element,ad;E.each(ac,function(af,ag){switch(af){case"minFileCount":case"maxFileCount":case"maxFileSize":ab[af]=S(ag);break;default:ab[af]=ag;break}});ab.fileInputCleared=false;ab.fileBatchCompleted=true;if(!ab.isPreviewable){ab.showPreview=false}ab.uploadFileAttr=!o(ae.attr("name"))?ae.attr("name"):"file_data";ab.reader=null;ab.formdata={};ab.clearStack();ab.uploadCount=0;ab.uploadStatus={};ab.uploadLog=[];ab.uploadAsyncCount=0;ab.loadedImages=[];ab.totalImagesCount=0;ab.ajaxRequests=[];ab.isError=false;ab.ajaxAborted=false;ab.cancelling=false;ad=ab.getLayoutTemplate("progress");ab.progressTemplate=ad.replace("{class}",ab.progressClass);ab.progressCompleteTemplate=ad.replace("{class}",ab.progressCompleteClass);ab.dropZoneEnabled=W()&&ab.dropZoneEnabled;ab.isDisabled=ab.$element.attr("disabled")||ab.$element.attr("readonly");ab.isUploadable=w()&&!o(ab.uploadUrl);ab.slug=typeof ac.slugCallback==="function"?ac.slugCallback:ab.slugDefault;ab.mainTemplate=ab.showCaption?ab.getLayoutTemplate("main1"):ab.getLayoutTemplate("main2");ab.captionTemplate=ab.getLayoutTemplate("caption");ab.previewGenericTemplate=ab.getPreviewTemplate("generic");if(ab.resizeImage&&(ab.maxImageWidth||ab.maxImageHeight)){ab.imageCanvas=document.createElement("canvas");ab.imageCanvasContext=ab.imageCanvas.getContext("2d")}if(o(ab.$element.attr("id"))){ab.$element.attr("id",r())}if(ab.$container===undefined){ab.$container=ab.createContainer()}else{ab.refreshContainer()}ab.$progress=ab.$container.find(".kv-upload-progress");ab.$btnUpload=ab.$container.find(".fileinput-upload");ab.$captionContainer=K(ac,"elCaptionContainer",ab.$container.find(".file-caption"));ab.$caption=K(ac,"elCaptionText",ab.$container.find(".file-caption-name"));ab.$previewContainer=K(ac,"elPreviewContainer",ab.$container.find(".file-preview"));ab.$preview=K(ac,"elPreviewImage",ab.$container.find(".file-preview-thumbnails"));ab.$previewStatus=K(ac,"elPreviewStatus",ab.$container.find(".file-preview-status"));ab.$errorContainer=K(ac,"elErrorContainer",ab.$previewContainer.find(".kv-fileinput-error"));if(!o(ab.msgErrorClass)){l(ab.$errorContainer,ab.msgErrorClass)}ab.$errorContainer.hide();ab.fileActionSettings=E.extend(L,ac.fileActionSettings);ab.previewInitId="preview-"+r();ab.id=ab.$element.attr("id");m.init(ab);ab.initPreview(true);ab.initPreviewDeletes();ab.options=ac;ab.setFileDropZoneTitle();ab.$element.removeClass("file-loading");if(ab.$element.attr("disabled")){ab.disable()}},parseError:function(ae,af,ah){var ac=this,ad=E.trim(af+""),ab=ad.slice(-1)==="."?"":".",ag=ae.responseJSON!==undefined&&ae.responseJSON.error!==undefined?ae.responseJSON.error:ae.responseText;if(ac.cancelling&&ac.msgUploadAborted){ad=ac.msgUploadAborted}if(ac.showAjaxErrorDetails&&ag){ag=E.trim(ag.replace(/\n\s*\n/g,"\n"));ag=ag.length>0?"<pre>"+ag+"</pre>":"";ad+=ab+ag}else{ad+=ab}ac.cancelling=false;return ah?"<b>"+ah+": </b>"+ad:ad},raise:function(ac,ae){var ab=this,ad=E.Event(ac);if(ae!==undefined){ab.$element.trigger(ad,ae)}else{ab.$element.trigger(ad)}if(ad.isDefaultPrevented()){return false}if(!ad.result){return ad.result}switch(ac){case"filebatchuploadcomplete":case"filebatchuploadsuccess":case"fileuploaded":case"fileclear":case"filecleared":case"filereset":case"fileerror":case"filefoldererror":case"fileuploaderror":case"filebatchuploaderror":case"filedeleteerror":case"filecustomerror":case"filesuccessremove":break;default:ab.ajaxAborted=ad.result;break}return true},getLayoutTemplate:function(ac){var ab=this,ad=J(ac,ab.layoutTemplates)?ab.layoutTemplates[ac]:a[ac];if(o(ab.customLayoutTags)){return ad}return e(ad,ab.customLayoutTags)},getPreviewTemplate:function(ac){var ab=this,ad=J(ac,ab.previewTemplates)?ab.previewTemplates[ac]:O[ac];if(o(ab.customPreviewTags)){return ad}return e(ad,ab.customPreviewTags)},parseFilePreviewIcon:function(ad,af){var ab=this,ac,ae=ab.previewFileIcon;if(af&&af.indexOf(".")>-1){ac=af.split(".").pop();if(ab.previewFileIconSettings&&ab.previewFileIconSettings[ac]){ae=ab.previewFileIconSettings[ac]}if(ab.previewFileExtSettings){E.each(ab.previewFileExtSettings,function(ag,ah){if(ab.previewFileIconSettings[ag]&&ah(ac)){ae=ab.previewFileIconSettings[ag]}})}}if(ad.indexOf("{previewFileIcon}")>-1){return ad.replace(/\{previewFileIconClass}/g,ab.previewFileIconClass).replace(/\{previewFileIcon}/g,ae)}return ad},getOutData:function(ad,ac,ae){var ab=this;ad=ad||{};ac=ac||{};ae=ae||ab.filestack.slice(0)||{};return{form:ab.formdata,files:ae,filenames:ab.filenames,extra:ab.getExtraData(),response:ac,reader:ab.reader,jqXHR:ad}},listen:function(){var ac=this,ad=ac.$element,ae=ac.$captionContainer,ag=ac.$btnFile,ab=ad.closest("form"),af=ac.$container;D(ad,"change",E.proxy(ac.change,ac));D(ag,"click",function(){ac.raise("filebrowse");if(ac.isError&&!ac.isUploadable){ac.clear()}ae.focus()});D(ab,"reset",E.proxy(ac.reset,ac));D(af.find(".fileinput-remove:not([disabled])"),"click",E.proxy(ac.clear,ac));D(af.find(".fileinput-cancel"),"click",E.proxy(ac.cancel,ac));if(ac.isUploadable&&ac.dropZoneEnabled&&ac.showPreview){ac.initDragDrop()}if(!ac.isUploadable){D(ab,"submit",E.proxy(ac.submitForm,ac))}D(ac.$container.find(".fileinput-upload"),"click",function(ak){var aj=E(this),ah,ai=!aj.hasClass("disabled")&&o(aj.attr("disabled"));if(!ac.isUploadable){if(ai&&aj.attr("type")!=="submit"){ah=aj.closest("form");if(ah.length){ah.trigger("submit")}ak.preventDefault()}return}ak.preventDefault();if(ai){ac.upload()}})},submitForm:function(){var ab=this,ac=ab.$element,ad=ac.get(0).files;if(ad&&ab.minFileCount>0&&ab.getFileCount(ad.length)<ab.minFileCount){ab.noFilesError({});return false}return !ab.abort({})},abort:function(ad){var ab=this,ac;if(ab.ajaxAborted&&typeof ab.ajaxAborted==="object"&&ab.ajaxAborted.message!==undefined){ac=E.extend(ab.getOutData(),ad);ac.abortData=ab.ajaxAborted.data||{};ac.abortMessage=ab.ajaxAborted.message;ab.cancel();ab.setProgress(100);ab.showUploadError(ab.ajaxAborted.message,ac,"filecustomerror");return true}return false},noFilesError:function(af){var ac=this,ad=ac.minFileCount>1?ac.filePlural:ac.fileSingle,ae=ac.msgFilesTooLess.replace("{n}",ac.minFileCount).replace("{files}",ad),ab=ac.$errorContainer;ac.addError(ae);ac.isError=true;ac.updateFileDetails(0);ab.fadeIn(800);ac.raise("fileerror",[af]);ac.clearFileInput();l(ac.$container,"has-error")},setProgress:function(af,ac){var ab=this,ae=Math.min(af,100),ad=ae<100?ab.progressTemplate:ab.progressCompleteTemplate;ac=ac||ab.$progress;if(!o(ad)){ac.html(ad.replace(/\{percent}/g,ae))}},lock:function(){var ab=this;ab.resetErrors();ab.disable();if(ab.showRemove){l(ab.$container.find(".fileinput-remove"),"hide")}if(ab.showCancel){ab.$container.find(".fileinput-cancel").removeClass("hide")}ab.raise("filelock",[ab.filestack,ab.getExtraData()])},unlock:function(ac){var ab=this;if(ac===undefined){ac=true}ab.enable();if(ab.showCancel){l(ab.$container.find(".fileinput-cancel"),"hide")}if(ab.showRemove){ab.$container.find(".fileinput-remove").removeClass("hide")}if(ac){ab.resetFileStack()}ab.raise("fileunlock",[ab.filestack,ab.getExtraData()])},resetFileStack:function(){var ab=this,ad=0,ae=[],ac=[];ab.getThumbs().each(function(){var ah=E(this),ag=ah.attr("data-fileindex"),af=ab.filestack[ag];if(ag===-1){return}if(af!==undefined){ae[ad]=af;ac[ad]=ab.getFileName(af);ah.attr({id:ab.previewInitId+"-"+ad,"data-fileindex":ad});ad++}else{ah.attr({id:"uploaded-"+r(),"data-fileindex":"-1"})}});ab.filestack=ae;ab.filenames=ac},destroy:function(){var ab=this,ac=ab.$container;ac.find(".file-drop-zone").off();ab.$element.insertBefore(ac).off(".fileinput").removeData();ac.off().remove()},refresh:function(ac){var ab=this,ad=ab.$element;ac=ac?E.extend(ab.options,ac):ab.options;ab.destroy();ad.fileinput(ac);if(ad.val()){ad.trigger("change.fileinput")}},initDragDrop:function(){var ac=this,ad=ac.$container.find(".file-drop-zone"),ab="dragenter.fileinput dragover.fileinput drop.fileinput";D(ad,"dragenter.fileinput dragover.fileinput",function(af){var ae=E.inArray("Files",af.originalEvent.dataTransfer.types)>-1;af.stopPropagation();af.preventDefault();if(ac.isDisabled||!ae){af.originalEvent.dataTransfer.effectAllowed="none";af.originalEvent.dataTransfer.dropEffect="none";return}l(E(this),"file-highlighted")},true);D(ad,"dragleave",function(ae){ae.stopPropagation();ae.preventDefault();if(ac.isDisabled){return}E(this).removeClass("file-highlighted")});D(ad,"drop",function(ae){ae.preventDefault();if(ac.isDisabled||o(ae.originalEvent.dataTransfer.files)){return}ac.change(ae,"dragdrop");E(this).removeClass("file-highlighted")});D(E(document),ab,function(ae){ae.stopPropagation();ae.preventDefault()},true)},setFileDropZoneTitle:function(){var ab=this,ac=ab.$container.find(".file-drop-zone");ac.find("."+ab.dropZoneTitleClass).remove();if(!ab.isUploadable||!ab.showPreview||ac.length===0||ab.getFileStack().length>0||!ab.dropZoneEnabled){return}if(ac.find(".file-preview-frame").length===0&&o(ab.defaultPreviewContent)){ac.prepend('<div class="'+ab.dropZoneTitleClass+'">'+ab.dropZoneTitle+"</div>")}ab.$container.removeClass("file-input-new");l(ab.$container,"file-input-ajax-new")},errorsExist:function(){var ab=this,ac;if(ab.$errorContainer.find("li").length){return true}ac=E(document.createElement("div")).html(ab.$errorContainer.html());ac.find("span.kv-error-close").remove();ac.find("ul").remove();return E.trim(ac.text()).length?true:false},getMsgSelected:function(ad){var ab=this,ac=ad===1?ab.fileSingle:ab.filePlural;return ab.msgSelected.replace("{n}",ad).replace("{files}",ac)},renderThumbProgress:function(){return'<div class="file-thumb-progress hide">'+this.progressTemplate.replace(/\{percent}/g,"0")+"</div>"},renderFileFooter:function(ac,ag){var ab=this,ae=ab.fileActionSettings,ah,ad,af=ab.getLayoutTemplate("footer");if(ab.isUploadable){ah=af.replace(/\{actions}/g,ab.renderFileActions(true,true,false,false,false));ad=ah.replace(/\{caption}/g,ac).replace(/\{width}/g,ag).replace(/\{progress}/g,ab.renderThumbProgress()).replace(/\{indicator}/g,ae.indicatorNew).replace(/\{indicatorTitle}/g,ae.indicatorNewTitle)}else{ad=af.replace(/\{actions}/g,"").replace(/\{caption}/g,ac).replace(/\{progress}/g,"").replace(/\{width}/g,ag).replace(/\{indicator}/g,"").replace(/\{indicatorTitle}/g,"")}ad=e(ad,ab.previewThumbTags);return ad},renderFileActions:function(ae,ab,ai,ad,an){if(!ae&&!ab){return""}var ao=this,ah=ad===false?"":' data-url="'+ad+'"',af=an===false?"":' data-key="'+an+'"',aj=ao.getLayoutTemplate("actionDelete"),ak="",am=ao.getLayoutTemplate("actions"),ac=ao.otherActionButtons.replace(/\{dataKey}/g,af),ag=ao.fileActionSettings,al=ai?ag.removeClass+" disabled":ag.removeClass;aj=aj.replace(/\{removeClass}/g,al).replace(/\{removeIcon}/g,ag.removeIcon).replace(/\{removeTitle}/g,ag.removeTitle).replace(/\{dataUrl}/g,ah).replace(/\{dataKey}/g,af);if(ae){ak=ao.getLayoutTemplate("actionUpload").replace(/\{uploadClass}/g,ag.uploadClass).replace(/\{uploadIcon}/g,ag.uploadIcon).replace(/\{uploadTitle}/g,ag.uploadTitle)}return am.replace(/\{delete}/g,aj).replace(/\{upload}/g,ak).replace(/\{other}/g,ac)},setThumbStatus:function(ai,ab){var ac=this;if(!ac.showPreview){return}var af="indicator"+ab,ah=af+"Title",ae="file-preview-"+ab.toLowerCase(),ag=ai.find(".file-upload-indicator"),ad=ac.fileActionSettings;ai.removeClass("file-preview-success file-preview-error file-preview-loading");if(ab==="Error"){ai.find(".kv-file-upload").attr("disabled",true)}ag.html(ad[af]);ag.attr("title",ad[ah]);ai.addClass(ae)},clearPreview:function(){var ab=this,ac=!ab.showUploadedThumbs?ab.$preview.find(".file-preview-frame"):ab.$preview.find(".file-preview-frame:not(.file-preview-success)");ac.remove();if(!ab.$preview.find(".file-preview-frame").length||!ab.showPreview){ab.resetUpload()}ab.validateDefaultPreview()},initPreview:function(ae){var ab=this,ad=ab.initialCaption||"",ac;if(!m.count(ab.id)){ab.clearPreview();if(ae){ab.setCaption(ad)}else{ab.initCaption()}return}ac=m.out(ab.id);ad=ae&&ab.initialCaption?ab.initialCaption:ac.caption;ab.$preview.html(ac.content);ab.setCaption(ad);if(!o(ac.content)){ab.$container.removeClass("file-input-new")}},initPreviewDeletes:function(){var ac=this,ab=ac.deleteExtraData||{},ad=function(){var ae=ac.isUploadable?m.count(ac.id):ac.$element.get(0).files.length;if(ac.$preview.find(".kv-file-remove").length===0&&!ae){ac.reset();ac.initialCaption=""}};ac.$preview.find(".kv-file-remove").each(function(){var an=E(this),al=an.data("url")||ac.deleteUrl,af=an.data("key");if(o(al)||af===undefined){return}var ag=an.closest(".file-preview-frame"),ae=m.data[ac.id],aj,ak,am=ag.data("fileindex"),ah,ai;am=parseInt(am.replace("init_",""));ah=o(ae.config)&&o(ae.config[am])?null:ae.config[am];ai=o(ah)||o(ah.extra)?ab:ah.extra;if(typeof ai==="function"){ai=ai()}ak={id:an.attr("id"),key:af,extra:ai};aj=E.extend({url:al,type:"POST",dataType:"json",data:E.extend({key:af},ai),beforeSend:function(ao){ac.ajaxAborted=false;ac.raise("filepredelete",[af,ao,ai]);if(ac.ajaxAborted){ao.abort()}else{l(ag,"file-uploading");l(an,"disabled")}},success:function(aq,at,ap){var ar,ao;if(o(aq)||o(aq.error)){m.unset(ac.id,am);ar=m.count(ac.id);ao=ar>0?ac.getMsgSelected(ar):"";ac.raise("filedeleted",[af,ap,ai]);ac.setCaption(ao)}else{ak.jqXHR=ap;ak.response=aq;ac.showError(aq.error,ak,"filedeleteerror");ag.removeClass("file-uploading");an.removeClass("disabled");ad();return}ag.removeClass("file-uploading").addClass("file-deleted");ag.fadeOut("slow",function(){ac.clearObjects(ag);ag.remove();ad();if(!ar&&ac.getFileStack().length===0){ac.setCaption("");ac.reset()}})},error:function(ap,ar,aq){var ao=ac.parseError(ap,aq);ak.jqXHR=ap;ak.response={};ac.showError(ao,ak,"filedeleteerror");ag.removeClass("file-uploading");ad()}},ac.ajaxDeleteSettings);D(an,"click",function(){if(!ac.validateMinCount()){return false}E.ajax(aj)})})},clearObjects:function(ab){ab.find("video audio").each(function(){this.pause();E(this).remove()});ab.find("img object div").each(function(){E(this).remove()})},clearFileInput:function(){var ad=this,ae=ad.$element,af,ab,ac;if(o(ae.val())){return}if(ad.isIE9||ad.isIE10){af=ae.closest("form");ab=E(document.createElement("form"));ac=E(document.createElement("div"));ae.before(ac);if(af.length){af.after(ab)}else{ac.after(ab)}ab.append(ae).trigger("reset");ac.before(ae).remove();ab.remove()}else{ae.val("")}ad.fileInputCleared=true},resetUpload:function(){var ab=this;ab.uploadCache={content:[],config:[],tags:[],append:true};ab.uploadCount=0;ab.uploadStatus={};ab.uploadLog=[];ab.uploadAsyncCount=0;ab.loadedImages=[];ab.totalImagesCount=0;ab.$btnUpload.removeAttr("disabled");ab.setProgress(0);l(ab.$progress,"hide");ab.resetErrors(false);ab.ajaxAborted=false;ab.ajaxRequests=[];ab.resetCanvas()},resetCanvas:function(){var ab=this;if(ab.canvas&&ab.imageCanvasContext){ab.imageCanvasContext.clearRect(0,0,ab.canvas.width,ab.canvas.height)}},cancel:function(){var ac=this,ae=ac.ajaxRequests,ab=ae.length,ad;if(ab>0){for(ad=0;ad<ab;ad+=1){ac.cancelling=true;ae[ad].abort()}}ac.getThumbs().each(function(){var ag=E(this),af=ag.attr("data-fileindex");ag.removeClass("file-uploading");if(ac.filestack[af]!==undefined){ag.find(".kv-file-upload").removeClass("disabled").removeAttr("disabled");ag.find(".kv-file-remove").removeClass("disabled").removeAttr("disabled")}ac.unlock()})},cleanMemory:function(ac){var ab=ac.is("img")?ac.attr("src"):ac.find("source").attr("src");V.revokeObjectURL(ab)},hasInitialPreview:function(){var ab=this;return !ab.overwriteInitial&&m.count(ab.id)},clear:function(){var ab=this,ac;ab.$btnUpload.removeAttr("disabled");ab.getThumbs().find("video,audio,img").each(function(){ab.cleanMemory(E(this))});ab.resetUpload();ab.clearStack();ab.clearFileInput();ab.resetErrors(true);ab.raise("fileclear");if(ab.hasInitialPreview()){ab.showFileIcon();ab.resetPreview();ab.initPreviewDeletes();ab.$container.removeClass("file-input-new")}else{ab.getThumbs().each(function(){ab.clearObjects(E(this))});if(ab.isUploadable){m.data[ab.id]={}}ab.$preview.html("");ac=(!ab.overwriteInitial&&ab.initialCaption.length>0)?ab.initialCaption:"";ab.setCaption(ac);ab.$caption.attr("title","");l(ab.$container,"file-input-new");ab.validateDefaultPreview()}if(ab.$container.find(".file-preview-frame").length===0){if(!ab.initCaption()){ab.$captionContainer.find(".kv-caption-icon").hide()}}ab.hideFileIcon();ab.raise("filecleared");ab.$captionContainer.focus();ab.setFileDropZoneTitle()},resetPreview:function(){var ab=this,ac,ad;if(m.count(ab.id)){ac=m.out(ab.id);ab.$preview.html(ac.content);ad=ab.initialCaption?ab.initialCaption:ac.caption;ab.setCaption(ad)}else{ab.clearPreview();ab.initCaption()}},clearDefaultPreview:function(){var ab=this;ab.$preview.find(".file-default-preview").remove()},validateDefaultPreview:function(){var ab=this;if(!ab.showPreview||o(ab.defaultPreviewContent)){return}ab.$preview.html('<div class="file-default-preview">'+ab.defaultPreviewContent+"</div>");ab.$container.removeClass("file-input-new")},resetPreviewThumbs:function(ad){var ab=this,ac;if(ad){ab.clearPreview();ab.clearStack();return}if(ab.hasInitialPreview()){ac=m.out(ab.id);ab.$preview.html(ac.content);ab.setCaption(ac.caption);ab.initPreviewDeletes()}else{ab.clearPreview()}},reset:function(){var ab=this;ab.resetPreview();ab.$container.find(".fileinput-filename").text("");ab.raise("filereset");l(ab.$container,"file-input-new");if(ab.$preview.find(".file-preview-frame").length||ab.isUploadable&&ab.dropZoneEnabled){ab.$container.removeClass("file-input-new")}ab.setFileDropZoneTitle();ab.clearStack();ab.formdata={}},disable:function(){var ab=this;ab.isDisabled=true;ab.raise("filedisabled");ab.$element.attr("disabled","disabled");ab.$container.find(".kv-fileinput-caption").addClass("file-caption-disabled");ab.$container.find(".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button").attr("disabled",true);ab.initDragDrop()},enable:function(){var ab=this;ab.isDisabled=false;ab.raise("fileenabled");ab.$element.removeAttr("disabled");ab.$container.find(".kv-fileinput-caption").removeClass("file-caption-disabled");ab.$container.find(".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button").removeAttr("disabled");ab.initDragDrop()},getThumbs:function(ab){ab=ab||"";return this.$preview.find(".file-preview-frame:not(.file-preview-initial)"+ab)},getExtraData:function(ab,ad){var ac=this,ae=ac.uploadExtraData;if(typeof ac.uploadExtraData==="function"){ae=ac.uploadExtraData(ab,ad)}return ae},uploadExtra:function(ab,ad){var ac=this,ae=ac.getExtraData(ab,ad);if(ae.length===0){return}E.each(ae,function(af,ag){ac.formdata.append(af,ag)})},setAsyncUploadStatus:function(ab,af,ae){var ac=this,ad=0;ac.setProgress(af,E("#"+ab).find(".file-thumb-progress"));ac.uploadStatus[ab]=af;E.each(ac.uploadStatus,function(ag,ah){ad+=ah});ac.setProgress(Math.ceil(ad/ae))},initXhr:function(ad,ab,ae){var ac=this;if(ad.upload){ad.upload.addEventListener("progress",function(ah){var ai=0,af=ah.loaded||ah.position,ag=ah.total;if(ah.lengthComputable){ai=Math.ceil(af/ag*100)}if(ab){ac.setAsyncUploadStatus(ab,ai,ae)}else{ac.setProgress(Math.ceil(ai))}},false)}return ad},ajaxSubmit:function(af,ah,ai,ad,ab,ae){var ac=this,ag;ac.raise("filepreajax",[ab,ae]);ac.uploadExtra(ab,ae);ag=E.extend({xhr:function(){var aj=E.ajaxSettings.xhr();return ac.initXhr(aj,ab,ac.getFileStack().length)},url:ac.uploadUrl,type:"POST",dataType:"json",data:ac.formdata,cache:false,processData:false,contentType:false,beforeSend:af,success:ah,complete:ai,error:ad},ac.ajaxSettings);ac.ajaxRequests.push(E.ajax(ag))},initUploadSuccess:function(ae,al,ab){var aj=this,ac,ag,ah,am,ai,ad,ak,af;if(!aj.showPreview||typeof ae!=="object"||E.isEmptyObject(ae)){return}if(ae.initialPreview!==undefined&&ae.initialPreview.length>0){aj.hasInitData=true;ai=ae.initialPreview||[];ad=ae.initialPreviewConfig||[];ak=ae.initialPreviewThumbTags||[];ac=ae.append===undefined||ae.append?true:false;aj.overwriteInitial=false;if(al!==undefined){if(!ab){ah=m.add(aj.id,ai,ad[0],ak[0],ac);ag=m.get(aj.id,ah,false);am=E(ag).hide();al.after(am).fadeOut("slow",function(){am.fadeIn("slow").css("display:inline-block");aj.initPreviewDeletes();aj.clearFileInput();al.remove()})}else{af=al.attr("data-fileindex");aj.uploadCache.content[af]=ai[0];aj.uploadCache.config[af]=ad[0];aj.uploadCache.tags[af]=ak[0];aj.uploadCache.append=ac}}else{m.set(aj.id,ai,ad,ak,ac);aj.initPreview();aj.initPreviewDeletes()}}},initSuccessThumbs:function(){var ab=this;if(!ab.showPreview){return}ab.getThumbs(".file-preview-success").each(function(){var ad=E(this),ac=ad.find(".kv-file-remove");ac.removeAttr("disabled");D(ac,"click",function(){var ae=ab.raise("filesuccessremove",[ad.attr("id"),ad.data("fileindex")]);ab.cleanMemory(ad);if(ae===false){return}ad.fadeOut("slow",function(){ad.remove();if(!ab.$preview.find(".file-preview-frame").length){ab.reset()}})})})},checkAsyncComplete:function(){var ac=this,ab,ad;for(ad=0;ad<ac.filestack.length;ad++){if(ac.filestack[ad]){ab=ac.previewInitId+"-"+ad;if(E.inArray(ab,ac.uploadLog)===-1){return false}}}return(ac.uploadAsyncCount===ac.uploadLog.length)},uploadSingle:function(ao,af,ae){var am=this,au=am.getFileStack().length,al=new FormData(),at,ab=am.previewInitId+"-"+ao,ai,an,ak,ar,ad=am.filestack.length>0||!E.isEmptyObject(am.uploadExtraData),ag,aj,ac,aq,ah,ap={id:ab,index:ao};am.formdata=al;if(am.showPreview){ai=E("#"+ab+":not(.file-preview-initial)");ak=ai.find(".kv-file-upload");ar=ai.find(".kv-file-remove");E("#"+ab).find(".file-thumb-progress").removeClass("hide")}if(au===0||!ad||(ak&&ak.hasClass("disabled"))||am.abort(ap)){return}ah=function(aw,av){am.updateStack(aw,undefined);am.uploadLog.push(av);if(am.checkAsyncComplete()){am.fileBatchCompleted=true}};an=function(){if(!am.fileBatchCompleted){return}setTimeout(function(){if(am.showPreview){m.set(am.id,am.uploadCache.content,am.uploadCache.config,am.uploadCache.tags,am.uploadCache.append);if(am.hasInitData){am.initPreview();am.initPreviewDeletes()}}am.unlock();am.clearFileInput();am.raise("filebatchuploadcomplete",[am.filestack,am.getExtraData()]);am.uploadCount=0;am.uploadStatus={};am.uploadLog=[];am.setProgress(100)},100)};ag=function(av){at=am.getOutData(av);am.fileBatchCompleted=false;if(am.showPreview){if(!ai.hasClass("file-preview-success")){am.setThumbStatus(ai,"Loading");l(ai,"file-uploading")}ak.attr("disabled",true);ar.attr("disabled",true)}if(!ae){am.lock()}am.raise("filepreupload",[at,ab,ao]);ap=E.extend(ap,at);if(am.abort(ap)){av.abort();am.setProgress(100)}};aj=function(aw,ax,av){at=am.getOutData(av,aw);ap=E.extend(ap,at);setTimeout(function(){if(o(aw)||o(aw.error)){if(am.showPreview){am.setThumbStatus(ai,"Success");ak.hide();am.initUploadSuccess(aw,ai,ae)}am.raise("fileuploaded",[at,ab,ao]);if(!ae){am.updateStack(ao,undefined)}else{ah(ao,ab)}}else{am.setThumbStatus(ai,"Error");am.showUploadError(aw.error,ap);if(ae){ah(ao,ab)}}},100)};ac=function(){setTimeout(function(){if(am.showPreview){ak.removeAttr("disabled");ar.removeAttr("disabled");ai.removeClass("file-uploading")}if(!ae){am.unlock(false);am.clearFileInput()}else{an()}am.initSuccessThumbs()},100)};aq=function(aw,ay,ax){var av=am.parseError(aw,ax,(ae?af[ao].name:null));setTimeout(function(){if(ae){ah(ao,ab)}am.uploadStatus[ab]=100;am.setThumbStatus(ai,"Error");ap=E.extend(ap,am.getOutData(aw));am.showUploadError(av,ap)},100)};al.append(am.uploadFileAttr,af[ao],am.filenames[ao]);al.append("file_id",ao);am.ajaxSubmit(ag,aj,ac,aq,ab,ao)},uploadBatch:function(){var ak=this,ab=ak.filestack,ai=ab.length,af={},ac=ak.filestack.length>0||!E.isEmptyObject(ak.uploadExtraData),ad,ag,aj,ae,ah;ak.formdata=new FormData();if(ai===0||!ac||ak.abort(af)){return}ad=function(){E.each(ab,function(al){ak.updateStack(al,undefined)});ak.clearFileInput()};ag=function(al){ak.lock();var am=ak.getOutData(al);if(ak.showPreview){ak.getThumbs().each(function(){var ap=E(this),an=ap.find(".kv-file-upload"),ao=ap.find(".kv-file-remove");if(!ap.hasClass("file-preview-success")){ak.setThumbStatus(ap,"Loading");l(ap,"file-uploading")}an.attr("disabled",true);ao.attr("disabled",true)})}ak.raise("filebatchpreupload",[am]);if(ak.abort(am)){al.abort();ak.setProgress(100)}};aj=function(ap,ar,ao){var aq=ak.getOutData(ao,ap),am=ak.getThumbs(),al=0,an=o(ap)||o(ap.errorkeys)?[]:ap.errorkeys;if(o(ap)||o(ap.error)){ak.raise("filebatchuploadsuccess",[aq]);ad();if(ak.showPreview){am.each(function(){var au=E(this),at=au.find(".kv-file-upload");au.find(".kv-file-upload").hide();ak.setThumbStatus(au,"Success");au.removeClass("file-uploading");at.removeAttr("disabled")});ak.initUploadSuccess(ap)}else{ak.reset()}}else{if(ak.showPreview){am.each(function(){var av=E(this),au=av.find(".kv-file-remove"),at=av.find(".kv-file-upload");av.removeClass("file-uploading");at.removeAttr("disabled");au.removeAttr("disabled");if(an.length===0){ak.setThumbStatus(av,"Error");return}if(E.inArray(al,an)!==-1){ak.setThumbStatus(av,"Error")}else{av.find(".kv-file-upload").hide();ak.setThumbStatus(av,"Success");ak.updateStack(al,undefined)}al++});ak.initUploadSuccess(ap)}ak.showUploadError(ap.error,aq,"filebatchuploaderror")}};ae=function(){ak.setProgress(100);ak.unlock();ak.initSuccessThumbs();ak.clearFileInput();ak.raise("filebatchuploadcomplete",[ak.filestack,ak.getExtraData()])};ah=function(am,ap,ao){var an=ak.getOutData(am),al=ak.parseError(am,ao);ak.showUploadError(al,an,"filebatchuploaderror");ak.uploadFileCount=ai-1;if(!ak.showPreview){return}ak.getThumbs().each(function(){var ar=E(this),aq=ar.attr("data-fileindex");ar.removeClass("file-uploading");if(ak.filestack[aq]!==undefined){ak.setThumbStatus(ar,"Error")}});ak.getThumbs().removeClass("file-uploading");ak.getThumbs(" .kv-file-upload").removeAttr("disabled");ak.getThumbs(" .kv-file-delete").removeAttr("disabled")};E.each(ab,function(al,am){if(!o(ab[al])){ak.formdata.append(ak.uploadFileAttr,am,ak.filenames[al])}});ak.ajaxSubmit(ag,aj,ae,ah)},uploadExtraOnly:function(){var ac=this,af={},ad,ae,ag,ab;ac.formdata=new FormData();if(ac.abort(af)){return}ad=function(ah){ac.lock();var ai=ac.getOutData(ah);ac.raise("filebatchpreupload",[ai]);ac.setProgress(50);af.data=ai;af.xhr=ah;if(ac.abort(af)){ah.abort();ac.setProgress(100)}};ae=function(ai,ak,ah){var aj=ac.getOutData(ah,ai);if(o(ai)||o(ai.error)){ac.raise("filebatchuploadsuccess",[aj]);ac.clearFileInput();ac.initUploadSuccess(ai)}else{ac.showUploadError(ai.error,aj,"filebatchuploaderror")}};ag=function(){ac.setProgress(100);ac.unlock();ac.clearFileInput();ac.raise("filebatchuploadcomplete",[ac.filestack,ac.getExtraData()])};ab=function(ai,al,ak){var aj=ac.getOutData(ai),ah=ac.parseError(ai,ak);af.data=aj;ac.showUploadError(ah,aj,"filebatchuploaderror")};ac.ajaxSubmit(ad,ae,ag,ab)},upload:function(){var ad=this,ac=ad.getFileStack().length,ah={},af,ag,ab,ae=!E.isEmptyObject(ad.getExtraData());if(ad.minFileCount>0&&ad.getFileCount(ac)<ad.minFileCount){ad.noFilesError(ah);return}if(!ad.isUploadable||ad.isDisabled||(ac===0&&!ae)){return}ad.resetUpload();ad.$progress.removeClass("hide");ad.uploadCount=0;ad.uploadStatus={};ad.uploadLog=[];ad.lock();ad.setProgress(2);if(ac===0&&ae){ad.uploadExtraOnly();return}ab=ad.filestack.length;ad.hasInitData=false;if(ad.uploadAsync){ag=ad.getOutData();ad.raise("filebatchpreupload",[ag]);ad.fileBatchCompleted=false;ad.uploadCache={content:[],config:[],tags:[],append:true};ad.uploadAsyncCount=ad.getFileStack().length;for(af=0;af<ab;af++){ad.uploadCache.content[af]=null;ad.uploadCache.config[af]=null;ad.uploadCache.tags[af]=null}for(af=0;af<ab;af++){if(ad.filestack[af]!==undefined){ad.uploadSingle(af,ad.filestack,true)}}return}ad.uploadBatch()},initFileActions:function(){var ab=this;if(!ab.showPreview){return}ab.$preview.find(".kv-file-remove").each(function(){var af=E(this),ag=af.closest(".file-preview-frame"),ac,aj=ag.attr("id"),ah=ag.attr("data-fileindex"),ai,ae,ad;D(af,"click",function(){ad=ab.raise("filepreremove",[aj,ah]);if(ad===false||!ab.validateMinCount()){return false}ac=ag.hasClass("file-preview-error");ab.cleanMemory(ag);ag.fadeOut("slow",function(){ab.updateStack(ah,undefined);ab.clearObjects(ag);ag.remove();if(aj&&ac){ab.$errorContainer.find('li[data-file-id="'+aj+'"]').fadeOut("fast",function(){E(this).remove();if(!ab.errorsExist()){ab.resetErrors()}})}var am=ab.getFileStack(true),ak=am.length,al=m.count(ab.id),an=ab.showPreview&&ab.$preview.find(".file-preview-frame").length;ab.clearFileInput();if(ak===0&&al===0&&!an){ab.reset()}else{ai=al+ak;ae=ai>1?ab.getMsgSelected(ai):(am[0]?ab.getFileNames()[0]:"");ab.setCaption(ae)}ab.raise("fileremoved",[aj,ah])})})});ab.$preview.find(".kv-file-upload").each(function(){var ac=E(this);D(ac,"click",function(){var ad=ac.closest(".file-preview-frame"),ae=ad.attr("data-fileindex");if(!ad.hasClass("file-preview-error")){ab.uploadSingle(ae,ab.filestack,false)}})})},hideFileIcon:function(){if(this.overwriteInitial){this.$captionContainer.find(".kv-caption-icon").hide()}},showFileIcon:function(){this.$captionContainer.find(".kv-caption-icon").show()},addError:function(ad){var ac=this,ab=ac.$errorContainer;if(ad&&ab.length){ab.html(ac.errorCloseButton+ad);ab.find(".kv-error-close").off("click").on("click",function(){ab.fadeOut("slow")})}},resetErrors:function(ad){var ac=this,ab=ac.$errorContainer;ac.isError=false;ac.$container.removeClass("has-error");ab.html("");if(ad){ab.fadeOut("slow")}else{ab.hide()}},showFolderError:function(ad){var ac=this,ab=ac.$errorContainer;if(!ad){return}ac.addError(ac.msgFoldersNotAllowed.replace(/\{n}/g,ad));ab.fadeIn(800);l(ac.$container,"has-error");ac.raise("filefoldererror",[ad])},showUploadError:function(ah,ag,ae){var ac=this,ab=ac.$errorContainer,ad=ae||"fileuploaderror",af=ag&&ag.id?'<li data-file-id="'+ag.id+'">'+ah+"</li>":"<li>"+ah+"</li>";if(ab.find("ul").length===0){ac.addError("<ul>"+af+"</ul>")}else{ab.find("ul").append(af)}ab.fadeIn(800);ac.raise(ad,[ag]);ac.$container.removeClass("file-input-new");l(ac.$container,"has-error");return true},showError:function(ag,af,ae){var ac=this,ab=ac.$errorContainer,ad=ae||"fileerror";af=af||{};af.reader=ac.reader;ac.addError(ag);ab.fadeIn(800);ac.raise(ad,[af]);if(!ac.isUploadable){ac.clearFileInput()}ac.$container.removeClass("file-input-new");l(ac.$container,"has-error");ac.$btnUpload.attr("disabled",true);return true},errorHandler:function(ab,ad){var ac=this,ae=ab.target.error;if(ae.code===ae.NOT_FOUND_ERR){ac.showError(ac.msgFileNotFound.replace("{name}",ad))}else{if(ae.code===ae.SECURITY_ERR){ac.showError(ac.msgFileSecured.replace("{name}",ad))}else{if(ae.code===ae.NOT_READABLE_ERR){ac.showError(ac.msgFileNotReadable.replace("{name}",ad))}else{if(ae.code===ae.ABORT_ERR){ac.showError(ac.msgFilePreviewAborted.replace("{name}",ad))}else{ac.showError(ac.msgFilePreviewError.replace("{name}",ad))}}}}},parseFileType:function(ae){var ac=this,ag,af,ab,ad;for(ad=0;ad<R.length;ad+=1){ab=R[ad];ag=J(ab,ac.fileTypeSettings)?ac.fileTypeSettings[ab]:T[ab];af=ag(ae.type,ae.name)?ab:"";if(!o(af)){return af}}return"other"},previewDefault:function(af,ah,aj){if(!this.showPreview){return}var al=this,ak="",ac=af?af.name:"",ag=V.createObjectURL(af),ad=ah.slice(ah.lastIndexOf("-")+1),ab=al.previewSettings.other||X.other,ai=al.renderFileFooter(af.name,ab.width),ae=al.parseFilePreviewIcon(al.getPreviewTemplate("other"),ac);if(aj===true){if(!al.isUploadable){ai+='<div class="file-other-error" title="'+al.fileActionSettings.indicatorErrorTitle+'">'+al.fileActionSettings.indicatorError+"</div>"}}al.clearDefaultPreview();al.$preview.append("\n"+ae.replace(/\{previewId}/g,ah).replace(/\{frameClass}/g,ak).replace(/\{fileindex}/g,ad).replace(/\{caption}/g,al.slug(af.name)).replace(/\{width}/g,ab.width).replace(/\{height}/g,ab.height).replace(/\{type}/g,af.type).replace(/\{data}/g,ag).replace(/\{footer}/g,ai));if(aj===true&&al.isUploadable){al.setThumbStatus(E("#"+ah),"Error")}},previewFile:function(ao,ar,am,ad,aw){if(!this.showPreview){return}var ai=this,af=ai.parseFileType(ar),au=ar?ar.name:"",aq=ai.slug(au),an,at,ah=ai.allowedPreviewTypes,ac=ai.allowedPreviewMimeTypes,ab=ai.getPreviewTemplate(af),aj=ah&&ah.indexOf(af)>=0,al,av=J(af,ai.previewSettings)?ai.previewSettings[af]:X[af],ae=ac&&ac.indexOf(ar.type)!==-1,ak=ai.renderFileFooter(aq,av.width),ap="",ag=ad.slice(ad.lastIndexOf("-")+1);if(aj||ae){ab=ai.parseFilePreviewIcon(ab,au.split(".").pop());if(af==="text"){at=q(am.target.result);al="text-"+r();an=ab.replace(/\{zoom}/g,ai.getLayoutTemplate("zoom"));ap=ai.getLayoutTemplate("modal").replace("{id}",al).replace(/\{title}/g,aq).replace(/\{body}/g,at).replace(/\{heading}/g,ai.msgZoomModalHeading);an=an.replace(/\{previewId}/g,ad).replace(/\{caption}/g,aq).replace(/\{width}/g,av.width).replace(/\{height}/g,av.height).replace(/\{frameClass}/g,"").replace(/\{zoomInd}/g,ai.zoomIndicator).replace(/\{footer}/g,ak).replace(/\{fileindex}/g,ag).replace(/\{type}/g,ar.type).replace(/\{zoomTitle}/g,ai.msgZoomTitle).replace(/\{dialog}/g,"$('#"+al+"').modal('show')").replace(/\{data}/g,at)+ap}else{an=ab.replace(/\{previewId}/g,ad).replace(/\{caption}/g,aq).replace(/\{frameClass}/g,"").replace(/\{type}/g,ar.type).replace(/\{fileindex}/g,ag).replace(/\{width}/g,av.width).replace(/\{height}/g,av.height).replace(/\{footer}/g,ak).replace(/\{data}/g,aw)}ai.clearDefaultPreview();ai.$preview.append("\n"+an);ai.validateImage(ao,ad,aq,ar.type)}else{ai.previewDefault(ar,ad)}},slugDefault:function(ab){return o(ab)?"":ab.split(/(\\|\/)/g).pop().replace(/[^\w\u00C0-\u017F\-.\\\/ ]+/g,"")},readFiles:function(ab){this.reader=new FileReader();var ao=this,ap=ao.$element,ah=ao.$preview,aj=ao.reader,am=ao.$previewContainer,an=ao.$previewStatus,ak=ao.msgLoading,ad=ao.msgProgress,ai=ao.previewInitId,ac=ab.length,ag=ao.fileTypeSettings,ae=ao.filestack.length,al,af=function(aw,at,aq,ar){var av=E.extend(ao.getOutData({},{},ab),{id:aq,index:ar}),au={id:aq,index:ar,file:at,files:ab};ao.previewDefault(at,aq,true);if(ao.isUploadable){ao.pushStack(undefined)}setTimeout(al(ar+1),100);ao.initFileActions();return ao.isUploadable?ao.showUploadError(aw,av):ao.showError(aw,au)};ao.loadedImages=[];ao.totalImagesCount=0;E.each(ab,function(at,ar){var aq="image",au=J(aq,ao.fileTypeSettings)?ao.fileTypeSettings[aq]:T[aq];if(au&&au(ar.type)){ao.totalImagesCount++}});al=function(aE){if(o(ap.attr("multiple"))){ac=1}if(aE>=ac){if(ao.isUploadable&&ao.filestack.length>0){ao.raise("filebatchselected",[ao.getFileStack()])}else{ao.raise("filebatchselected",[ab])}am.removeClass("file-thumb-loading");an.html("");return}var aB=ae+aE,ar=ai+"-"+aB,aA,aH=ab[aE],aF=ao.slug(aH.name),az=(aH.size||0)/1000,av,at="",ax=V.createObjectURL(aH),aI=0,aD,aw,aJ,aG,aq=ao.allowedFileTypes,aC=o(aq)?"":aq.join(", "),ay=ao.allowedFileExtensions,au=o(ay)?"":ay.join(", ");if(!o(ay)){at=new RegExp("\\.("+ay.join("|")+")$","i")}az=az.toFixed(2);if(ao.maxFileSize>0&&az>ao.maxFileSize){aw=ao.msgSizeTooLarge.replace("{name}",aF).replace("{size}",az).replace("{maxSize}",ao.maxFileSize);ao.isError=af(aw,aH,ar,aE);return}if(!o(aq)&&v(aq)){for(aD=0;aD<aq.length;aD+=1){aJ=aq[aD];av=ag[aJ];aG=(av!==undefined&&av(aH.type,aF));aI+=o(aG)?0:aG.length}if(aI===0){aw=ao.msgInvalidFileType.replace("{name}",aF).replace("{types}",aC);ao.isError=af(aw,aH,ar,aE);return}}if(aI===0&&!o(ay)&&v(ay)&&!o(at)){aG=aF.match(at);aI+=o(aG)?0:aG.length;if(aI===0){aw=ao.msgInvalidFileExtension.replace("{name}",aF).replace("{extensions}",au);ao.isError=af(aw,aH,ar,aE);return}}if(!ao.showPreview){ao.pushStack(aH);setTimeout(al(aE+1),100);ao.raise("fileloaded",[aH,ar,aE,aj]);return}if(ah.length>0&&FileReader!==undefined){an.html(ak.replace("{index}",aE+1).replace("{files}",ac));am.addClass("file-thumb-loading");aj.onerror=function(aK){ao.errorHandler(aK,aF)};aj.onload=function(aK){ao.previewFile(aE,aH,aK,ar,ax);ao.initFileActions()};aj.onloadend=function(){aw=ad.replace("{index}",aE+1).replace("{files}",ac).replace("{percent}",50).replace("{name}",aF);setTimeout(function(){an.html(aw);ao.updateFileDetails(ac);al(aE+1)},100);ao.raise("fileloaded",[aH,ar,aE,aj])};aj.onprogress=function(aM){if(aM.lengthComputable){var aL=(aM.loaded/aM.total)*100,aK=Math.ceil(aL);aw=ad.replace("{index}",aE+1).replace("{files}",ac).replace("{percent}",aK).replace("{name}",aF);setTimeout(function(){an.html(aw)},100)}};aA=J("text",ag)?ag.text:T.text;if(aA(aH.type,aF)){aj.readAsText(aH,ao.textEncoding)}else{aj.readAsArrayBuffer(aH)}}else{ao.previewDefault(aH,ar);setTimeout(function(){al(aE+1);ao.updateFileDetails(ac)},100);ao.raise("fileloaded",[aH,ar,aE,aj])}ao.pushStack(aH)};al(0);ao.updateFileDetails(ac,false)},updateFileDetails:function(ac){var ai=this,aj=ai.$element,af=ai.getFileStack(),ab=aj.val()||(af.length&&af[0].name)||"",ah=ai.slug(ab),ad=ai.isUploadable?af.length:ac,ag=m.count(ai.id)+ad,ae=ad>1?ai.getMsgSelected(ag):ah;if(ai.isError){ai.$previewContainer.removeClass("file-thumb-loading");ai.$previewStatus.html("");ai.$captionContainer.find(".kv-caption-icon").hide()}else{ai.showFileIcon()}ai.setCaption(ae,ai.isError);ai.$container.removeClass("file-input-new file-input-ajax-new");if(arguments.length===1){ai.raise("fileselect",[ac,ah])}if(m.count(ai.id)){ai.initPreviewDeletes()}},validateMinCount:function(){var ac=this,ab=ac.isUploadable?ac.getFileStack().length:ac.$element.get(0).files.length;if(ac.validateInitialCount&&ac.minFileCount>0&&ac.getFileCount(ab-1)<ac.minFileCount){ac.noFilesError({});return false}return true},getFileCount:function(ad){var ab=this,ac=0;if(ab.validateInitialCount&&!ab.overwriteInitial){ac=m.count(ab.id);ad+=ac}return ad},change:function(ap){var ai=this,ar=ai.$element;if(!ai.isUploadable&&o(ar.val())&&ai.fileInputCleared){ai.fileInputCleared=false;return}ai.fileInputCleared=false;var ah,ac,at,af=arguments.length>1,ad=af?ap.originalEvent.dataTransfer.files:ar.get(0).files,ag=o(ar.attr("multiple")),ak=0,an,aj,am=0,ao=ai.filestack.length,ab=ai.isUploadable,al,ae=(ag&&ao>0),aq=function(au,ax,av,aw){var az=E.extend(ai.getOutData({},{},ad),{id:av,index:aw}),ay={id:av,index:aw,file:ax,files:ad};return ai.isUploadable?ai.showUploadError(au,az):ai.showError(au,ay)};ai.reader=null;ai.resetUpload();ai.hideFileIcon();if(ai.isUploadable){ai.$container.find(".file-drop-zone ."+ai.dropZoneTitleClass).remove()}if(af){ah=[];while(ad[ak]){an=ad[ak];if(!an.type&&an.size%4096===0){am++}else{ah.push(an)}ak++}}else{if(ap.target.files===undefined){ah=ap.target&&ap.target.value?[{name:ap.target.value.replace(/^.+\\/,"")}]:[]}else{ah=ap.target.files}}if(o(ah)||ah.length===0){if(!ab){ai.clear()}ai.showFolderError(am);ai.raise("fileselectnone");return}ai.resetErrors();al=ah.length;at=ai.isUploadable?ai.getFileStack().length+al:al;at=ai.getFileCount(at);if(ai.maxFileCount>0&&at>ai.maxFileCount){if(!ai.autoReplace||al>ai.maxFileCount){aj=(ai.autoReplace&&al>ai.maxFileCount)?al:at;ac=ai.msgFilesTooMany.replace("{m}",ai.maxFileCount).replace("{n}",aj);ai.isError=aq(ac,null,null,null);ai.$captionContainer.find(".kv-caption-icon").hide();ai.setCaption("",true);ai.$container.removeClass("file-input-new file-input-ajax-new");return}if(at>ai.maxFileCount){ai.resetPreviewThumbs(ab)}}else{if(!ab||ae){ai.resetPreviewThumbs(false);if(ae){ai.clearStack()}}else{if(ab&&ao===0&&(!m.count(ai.id)||ai.overwriteInitial)){ai.resetPreviewThumbs(true)}}}if(ai.isPreviewable){ai.readFiles(ah)}else{ai.updateFileDetails(1)}ai.showFolderError(am)},getFileName:function(ab){return ab&&ab.name?this.slug(ab.name):undefined},getFileNames:function(ab){var ac=this;return ac.filenames.filter(function(ad){return(ab?ad!==undefined:ad!==undefined&&ad!==null)})},getFileStack:function(ab){var ac=this;return ac.filestack.filter(function(ad){return(ab?ad!==undefined:ad!==undefined&&ad!==null)})},clearStack:function(){var ab=this;ab.filestack=[];ab.filenames=[]},updateStack:function(ad,ac){var ab=this;ab.filestack[ad]=ac;ab.filenames[ad]=ab.getFileName(ac)},pushStack:function(ac){var ab=this;ab.filestack.push(ac);ab.filenames.push(ab.getFileName(ac))},checkDimensions:function(ah,ak,ab,ao,ae,aj,ag){var am=this,ad,ai,an=ak==="Small"?"min":"max",af=am[an+"Image"+aj],ac,al;if(o(af)||!ab.length){return}ac=ab[0];ai=(aj==="Width")?ac.naturalWidth||ac.width:ac.naturalHeight||ac.height;al=ak==="Small"?ai>=af:ai<=af;if(al){return}ad=am["msgImage"+aj+ak].replace("{name}",ae).replace("{size}",af);am.showUploadError(ad,ag);am.setThumbStatus(ao,"Error");am.updateStack(ah,null)},validateImage:function(ag,ai,ac,aj){var ak=this,ae=ak.$preview,ad,ah,af,al=ae.find("#"+ai),ab=al.find("img");ac=ac||"Untitled";if(!ab.length){return}D(ab,"load",function(){ah=al.width();af=ae.width();if(ah>af){ab.css("width","100%");al.css("width","97%")}ad={ind:ag,id:ai};ak.checkDimensions(ag,"Small",ab,al,ac,"Width",ad);ak.checkDimensions(ag,"Small",ab,al,ac,"Height",ad);if(!ak.resizeImage){ak.checkDimensions(ag,"Large",ab,al,ac,"Width",ad);ak.checkDimensions(ag,"Large",ab,al,ac,"Height",ad)}ak.raise("fileimageloaded",[ai]);ak.loadedImages.push({ind:ag,img:ab,thumb:al,pid:ai,typ:aj});ak.validateAllImages();V.revokeObjectURL(ab.attr("src"))})},validateAllImages:function(){var ai=this,af,ad,ab,aj,ag,ac,ae={},ah;if(ai.loadedImages.length!==ai.totalImagesCount){return}ai.raise("fileimagesloaded");if(!ai.resizeImage){return}ah=ai.isUploadable?ai.showUploadError:ai.showError;for(af=0;af<ai.loadedImages.length;af++){ad=ai.loadedImages[af];ab=ad.img;aj=ad.thumb;ag=ad.pid;ac=ad.ind;ae={id:ag,index:ac};if(!ai.getResizedImage(ab[0],ad.typ,ag,ac)){ah(ai.msgImageResizeError,ae,"fileimageresizeerror");ai.setThumbStatus(aj,"Error");ai.updateStack(ac,undefined)}}ai.raise("fileimagesresized")},getResizedImage:function(ah,am,ak,ae){var aq=this,ac=ah.naturalWidth,ap=ah.naturalHeight,al=1,ao=aq.maxImageWidth||ac,an=aq.maxImageHeight||ap,aj=(ac&&ap),ag,af,ad=aq.imageCanvas,ab=aq.imageCanvasContext;if(!aj){return false}if(ac===ao&&ap===an){return true}am=am||aq.resizeDefaultImageType;ag=ac>ao;af=ap>an;if(aq.resizePreference==="width"){al=ag?ao/ac:(af?an/ap:1)}else{al=af?an/ap:(ag?ao/ac:1)}aq.resetCanvas();ac*=al;ap*=al;ad.width=ac;ad.height=ap;try{ab.drawImage(ah,0,0,ac,ap);ad.toBlob(function(ar){aq.raise("fileimageresized",[ak,ae]);aq.filestack[ae]=ar},am,aq.resizeQuality);return true}catch(ai){return false}},initCaption:function(){var ab=this,ac=ab.initialCaption||"";if(ab.overwriteInitial||o(ac)){ab.$caption.html("");return false}ab.setCaption(ac);return true},setCaption:function(ae,ad){var ab=this,af,ac;if(ad){af=E("<div>"+ab.msgValidationError+"</div>").text();ac='<span class="'+ab.msgValidationErrorClass+'">'+ab.msgValidationErrorIcon+af+"</span>"}else{if(o(ae)||ab.$caption.length===0){return}af=E("<div>"+ae+"</div>").text();ac=ab.getLayoutTemplate("icon")+af}ab.$caption.html(ac);ab.$caption.attr("title",af);ab.$captionContainer.find(".file-caption-ellipsis").attr("title",af)},initBrowse:function(ac){var ab=this;ab.$btnFile=ac.find(".btn-file");ab.$btnFile.append(ab.$element)},createContainer:function(){var ab=this,ac=E(document.createElement("div")).attr({"class":"file-input file-input-new"}).html(ab.renderMain());ab.$element.before(ac);ab.initBrowse(ac);return ac},refreshContainer:function(){var ab=this,ac=ab.$container;ac.before(ab.$element);ac.html(ab.renderMain());ab.initBrowse(ac)},renderMain:function(){var ac=this,ae=(ac.isUploadable&&ac.dropZoneEnabled)?" file-drop-zone":"file-drop-disabled",ag=!ac.showClose?"":ac.getLayoutTemplate("close"),af=!ac.showPreview?"":ac.getLayoutTemplate("preview").replace(/\{class}/g,ac.previewClass).replace(/\{dropClass}/g,ae),ad=ac.isDisabled?ac.captionClass+" file-caption-disabled":ac.captionClass,ab=ac.captionTemplate.replace(/\{class}/g,ad+" kv-fileinput-caption");return ac.mainTemplate.replace(/\{class}/g,ac.mainClass).replace(/\{preview}/g,af).replace(/\{close}/g,ag).replace(/\{caption}/g,ab).replace(/\{upload}/g,ac.renderButton("upload")).replace(/\{remove}/g,ac.renderButton("remove")).replace(/\{cancel}/g,ac.renderButton("cancel")).replace(/\{browse}/g,ac.renderButton("browse"))},renderButton:function(af){var aj=this,ab=aj.getLayoutTemplate("btnDefault"),ae=aj[af+"Class"],ah=aj[af+"Title"],ag=aj[af+"Icon"],ai=aj[af+"Label"],ad=aj.isDisabled?" disabled":"",ac="button";switch(af){case"remove":if(!aj.showRemove){return""}break;case"cancel":if(!aj.showCancel){return""}ae+=" hide";break;case"upload":if(!aj.showUpload){return""}if(aj.isUploadable&&!aj.isDisabled){ab=aj.getLayoutTemplate("btnLink").replace("{href}",aj.uploadUrl)}else{ac="submit"}break;case"browse":ab=aj.getLayoutTemplate("btnBrowse");break;default:return""}ae+=af==="browse"?" btn-file":" fileinput-"+af+" fileinput-"+af+"-button";if(!o(ai)){ai=' <span class="'+aj.buttonLabelClass+'">'+ai+"</span>"}return ab.replace("{type}",ac).replace("{css}",ae).replace("{title}",ah).replace("{status}",ad).replace("{icon}",ag).replace("{label}",ai)}};E.fn.fileinput=function(ad){if(!u()&&!j(9)){return}var ac=Array.apply(null,arguments),ab=[];ac.shift();this.each(function(){var ae=E(this),ah=ae.data("fileinput"),ag=typeof ad==="object"&&ad,ai=ag.language||ae.data("language")||"en",af=E.fn.fileinput.defaults;if(!ah){if(ai!=="en"&&!o(E.fn.fileinputLocales[ai])){E.extend(af,E.fn.fileinputLocales[ai])}ah=new k(this,E.extend(af,ag,ae.data()));ae.data("fileinput",ah)}if(typeof ad==="string"){ab.push(ah[ad].apply(ah,ac))}});switch(ab.length){case 0:return this;case 1:return ab[0];default:return ab}};E.fn.fileinput.defaults={language:"en",showCaption:true,showPreview:true,showRemove:true,showUpload:true,showCancel:true,showClose:true,showUploadedThumbs:true,autoReplace:false,mainClass:"",previewClass:"",captionClass:"",mainTemplate:null,initialCaption:"",initialPreview:[],initialPreviewDelimiter:"*$$*",initialPreviewConfig:[],initialPreviewThumbTags:[],previewThumbTags:{},initialPreviewShowDelete:true,deleteUrl:"",deleteExtraData:{},overwriteInitial:true,layoutTemplates:a,previewTemplates:O,allowedPreviewTypes:R,allowedPreviewMimeTypes:null,allowedFileTypes:null,allowedFileExtensions:null,defaultPreviewContent:null,customLayoutTags:{},customPreviewTags:{},previewSettings:X,fileTypeSettings:T,previewFileIcon:'<i class="glyphicon glyphicon-file"></i>',previewFileIconClass:"file-icon-4x",previewFileIconSettings:{},previewFileExtSettings:{},buttonLabelClass:"hidden-xs",browseIcon:'<i class="glyphicon glyphicon-folder-open"></i>',browseClass:"btn btn-primary",removeIcon:'<i class="glyphicon glyphicon-trash"></i>',removeClass:"btn btn-default",cancelIcon:'<i class="glyphicon glyphicon-ban-circle"></i>',cancelClass:"btn btn-default",uploadIcon:'<i class="glyphicon glyphicon-upload"></i>',uploadClass:"btn btn-default",uploadUrl:null,uploadAsync:true,uploadExtraData:{},minImageWidth:null,minImageHeight:null,maxImageWidth:null,maxImageHeight:null,resizeImage:false,resizePreference:"width",resizeQuality:0.92,resizeDefaultImageType:"image/jpeg",maxFileSize:0,minFileCount:0,maxFileCount:0,validateInitialCount:false,msgValidationErrorClass:"text-danger",msgValidationErrorIcon:'<i class="glyphicon glyphicon-exclamation-sign"></i> ',msgErrorClass:"file-error-message",progressThumbClass:"progress-bar progress-bar-success progress-bar-striped active",progressClass:"progress-bar progress-bar-success progress-bar-striped active",progressCompleteClass:"progress-bar progress-bar-success",previewFileType:"image",zoomIndicator:'<i class="glyphicon glyphicon-zoom-in"></i>',elCaptionContainer:null,elCaptionText:null,elPreviewContainer:null,elPreviewImage:null,elPreviewStatus:null,elErrorContainer:null,errorCloseButton:'<span class="close kv-error-close">&times;</span>',slugCallback:null,dropZoneEnabled:true,dropZoneTitleClass:"file-drop-zone-title",fileActionSettings:{},otherActionButtons:"",textEncoding:"UTF-8",ajaxSettings:{},ajaxDeleteSettings:{},showAjaxErrorDetails:true};E.fn.fileinputLocales.en={fileSingle:"file",filePlural:"files",browseLabel:"Browse &hellip;",removeLabel:"Remove",removeTitle:"Clear selected files",cancelLabel:"Cancel",cancelTitle:"Abort ongoing upload",uploadLabel:"Upload",uploadTitle:"Upload selected files",msgZoomTitle:"View details",msgZoomModalHeading:"Detailed Preview",msgSizeTooLarge:'File "{name}" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>.',msgFilesTooLess:"You must select at least <b>{n}</b> {files} to upload.",msgFilesTooMany:"Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>.",msgFileNotFound:'File "{name}" not found!',msgFileSecured:'Security restrictions prevent reading the file "{name}".',msgFileNotReadable:'File "{name}" is not readable.',msgFilePreviewAborted:'File preview aborted for "{name}".',msgFilePreviewError:'An error occurred while reading the file "{name}".',msgInvalidFileType:'Invalid type for file "{name}". Only "{types}" files are supported.',msgInvalidFileExtension:'Invalid extension for file "{name}". Only "{extensions}" files are supported.',msgUploadAborted:"The file upload was aborted",msgValidationError:"File Upload Error",msgLoading:"Loading file {index} of {files} &hellip;",msgProgress:"Loading file {index} of {files} - {name} - {percent}% completed.",msgSelected:"{n} {files} selected",msgFoldersNotAllowed:"Drag & drop files only! {n} folder(s) dropped were skipped.",msgImageWidthSmall:'Width of image file "{name}" must be at least {size} px.',msgImageHeightSmall:'Height of image file "{name}" must be at least {size} px.',msgImageWidthLarge:'Width of image file "{name}" cannot exceed {size} px.',msgImageHeightLarge:'Height of image file "{name}" cannot exceed {size} px.',msgImageResizeError:"Could not get the image dimensions to resize.",msgImageResizeException:"Error while resizing the image.<pre>{errors}</pre>",dropZoneTitle:"Drag & drop files here &hellip;"};E.fn.fileinputLocales.zh={fileSingle:"\u6587\u4ef6",filePlural:"\u591a\u4e2a\u6587\u4ef6",browseLabel:"\u9009\u62e9 &hellip;",removeLabel:"\u79fb\u9664",removeTitle:"\u6e05\u9664\u9009\u4e2d\u6587\u4ef6",cancelLabel:"\u53d6\u6d88",cancelTitle:"\u53d6\u6d88\u8fdb\u884c\u4e2d\u7684\u4e0a\u4f20",uploadLabel:"\u4e0a\u4f20",uploadTitle:"\u4e0a\u4f20\u9009\u4e2d\u6587\u4ef6",msgZoomTitle:"\u67e5\u770b\u8be6\u60c5",msgZoomModalHeading:"\u8be6\u7ec6\u9884\u89c8",msgSizeTooLarge:'\u6587\u4ef6 "{name}" (<b>{size} KB</b>) \u8d85\u8fc7\u4e86\u5141\u8bb8\u5927\u5c0f <b>{maxSize} KB</b>.',msgFilesTooLess:"\u4f60\u5fc5\u987b\u9009\u62e9\u6700\u5c11 <b>{n}</b> {files} \u6765\u4e0a\u4f20. ",msgFilesTooMany:"\u9009\u62e9\u7684\u4e0a\u4f20\u6587\u4ef6\u4e2a\u6570 <b>({n})</b> \u8d85\u51fa\u6700\u5927\u6587\u4ef6\u7684\u9650\u5236\u4e2a\u6570 <b>{m}</b>.",msgFileNotFound:'\u6587\u4ef6 "{name}" \u672a\u627e\u5230!',msgFileSecured:'\u5b89\u5168\u9650\u5236\uff0c\u4e3a\u4e86\u9632\u6b62\u8bfb\u53d6\u6587\u4ef6 "{name}".',msgFileNotReadable:'\u6587\u4ef6 "{name}" \u4e0d\u53ef\u8bfb.',msgFilePreviewAborted:'\u53d6\u6d88 "{name}" \u7684\u9884\u89c8.',msgFilePreviewError:'\u8bfb\u53d6 "{name}" \u65f6\u51fa\u73b0\u4e86\u4e00\u4e2a\u9519\u8bef.',msgInvalidFileType:'\u4e0d\u6b63\u786e\u7684\u7c7b\u578b "{name}". \u53ea\u652f\u6301 "{types}" \u7c7b\u578b\u7684\u6587\u4ef6.',msgInvalidFileExtension:'\u4e0d\u6b63\u786e\u7684\u6587\u4ef6\u6269\u5c55\u540d "{name}". \u53ea\u652f\u6301 "{extensions}" \u7684\u6587\u4ef6\u6269\u5c55\u540d.',msgUploadAborted:"\u8be5\u6587\u4ef6\u4e0a\u4f20\u88ab\u4e2d\u6b62",msgValidationError:"\u6587\u4ef6\u4e0a\u4f20\u9519\u8bef",msgLoading:"\u52a0\u8f7d\u7b2c {index} \u6587\u4ef6 \u5171 {files} &hellip;",msgProgress:"\u52a0\u8f7d\u7b2c {index} \u6587\u4ef6 \u5171 {files} - {name} - {percent}% \u5b8c\u6210.",msgSelected:"{n} {files} \u9009\u4e2d",msgFoldersNotAllowed:"\u53ea\u652f\u6301\u62d6\u62fd\u6587\u4ef6! \u8df3\u8fc7 {n} \u62d6\u62fd\u7684\u6587\u4ef6\u5939.",msgImageWidthSmall:'\u5bbd\u5ea6\u7684\u56fe\u50cf\u6587\u4ef6\u7684"{name}"\u7684\u5fc5\u987b\u662f\u81f3\u5c11{size}\u50cf\u7d20.',msgImageHeightSmall:'\u56fe\u50cf\u6587\u4ef6\u7684"{name}"\u7684\u9ad8\u5ea6\u5fc5\u987b\u81f3\u5c11\u4e3a{size}\u50cf\u7d20.',msgImageWidthLarge:'\u5bbd\u5ea6\u7684\u56fe\u50cf\u6587\u4ef6"{name}"\u4e0d\u80fd\u8d85\u8fc7{size}\u50cf\u7d20.',msgImageHeightLarge:'\u56fe\u50cf\u6587\u4ef6"{name}"\u7684\u9ad8\u5ea6\u4e0d\u80fd\u8d85\u8fc7{size}\u50cf\u7d20.',msgImageResizeError:"\u65e0\u6cd5\u83b7\u53d6\u7684\u56fe\u50cf\u5c3a\u5bf8\u8c03\u6574\u3002",msgImageResizeException:"\u9519\u8bef\u800c\u8c03\u6574\u56fe\u50cf\u5927\u5c0f\u3002<pre>{errors}</pre>",dropZoneTitle:"\u62d6\u62fd\u6587\u4ef6\u5230\u8fd9\u91cc &hellip;",slugCallback:function(ab){return ab?ab.split(/(\\|\/)/g).pop().replace(/[^\w\u4e00-\u9fa5\-.\\\/ ]+/g,""):""},fileActionSettings:{removeTitle:"\u5220\u9664\u6587\u4ef6",uploadTitle:"\u4e0a\u4f20\u6587\u4ef6",indicatorNewTitle:"\u6ca1\u6709\u4e0a\u4f20",indicatorSuccessTitle:"\u4e0a\u4f20",indicatorErrorTitle:"\u4e0a\u4f20\u9519\u8bef",indicatorLoadingTitle:"\u4e0a\u4f20 ..."}};E.extend(E.fn.fileinput.defaults,E.fn.fileinputLocales.zh);E.fn.fileinput.Constructor=k;E(document).ready(function(){var ab=E("input.file[type=file]");if(ab.length){ab.fileinput()}})}));
